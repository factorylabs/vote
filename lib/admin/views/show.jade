extend ../../views/layout

block footer
  != js('admin')

block content
  h2.factoryize.upcase= contest.name
  p
    | Open:&nbsp;
    input#open-contest(type='checkbox', checked=contest.open ? 'checked' : undefined, data-contest=contest.id)
    |  Show Results:&nbsp;
    input#show-results(type='checkbox', checked=contest.show_results ? 'checked' : undefined, data-contest=contest.id)

  if contest.categories.length == 0
    p: small No categories

  else
    for category in contest.categories
      .admin.category-container

        h3.factoryize.bold.orange= category.name

        form.delete-entity(method='post', action="/admin/contests/#{contest.id}/categories/#{category.id}/")
          input(type='hidden', name='_method', value='delete')
          input.btn(type='submit', value='Delete')

        if category.entries.length == 0
          p: small No entries in this category
        else
          .entries.clearfix
            for entry in category.entries
              .entry
                form.delete-entity(method='post', action="/admin/contests/#{contest.id}/categories/#{category.id}/entries/#{entry.id}")
                  input(type='hidden', name='_method', value='delete')
                  input.btn(type='submit', value='Delete')
                if entry.slug
                  img.img-polaroid(src="http://instagr.am/p/#{entry.slug}/media/?size=t")
                else if entry.image_url
                  img.img-polaroid(src=entry.image_url)
                if entry.name
                  h4= entry.name
                span.badge.pull-right= entry.votes

        form.form-inline(action="/admin/contests/#{contest.id}/categories/#{category.id}/entries", method='POST')
          input.input-large(type='text', name='name', placeholder='Entry Name')
          | &nbsp;
          input(type='text', name='slug', placeholder='Instagram Slug')
          = ' orÂ '
          input(type='text', name='image_url', placeholder='Photo URL')
          | &nbsp;
          input.btn(type='submit', value='Add')

  h5 Add Category to Contest
  form.form-inline(action="/admin/contests/#{contest.id}/categories", method='POST')
    input.input-large(type='text', name='name', placeholder='Category Name')
    | &nbsp;
    input.btn(type='submit', value='Create Category')
